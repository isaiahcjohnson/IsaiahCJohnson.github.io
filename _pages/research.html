---
layout: archive
title: "Research"
permalink: /research/
author_profile: true
---

{% include base_path %}

{%- comment -%}
Debug counter: confirms Jekyll sees your collection
{%- endcomment -%}
<p style="font-size:0.9em;color:#666;">Total research items: {{ site.research | size }}</p>

{%- assign cats = site.research_category -%}

{%- comment -%}
Stable display order. Keys must match your items' category (or categories) values.
{%- endcomment -%}
{%- assign order = "books,manuscripts,working_papers,works_in_progress,conferences,reports" | split: "," -%}

{%- for key in order -%}
  {%- assign k = key | strip -%}
  {%- assign heading = cats[k].title | default: k -%}

  {%- comment -%}
  Gather items that match either:
    category: k
    OR categories: [ ... k ... ]
  {%- endcomment -%}
  {%- assign items_strict = site.research | where: "category", k -%}
  {%- assign items_array  = site.research | where_exp: "it", "it.categories and it.categories contains k" -%}
  {%- assign items = items_strict | concat: items_array | sort: "date" | reverse -%}

  {%- if items.size > 0 -%}
    <h2>{{ heading }}</h2><hr />
    {%- for post in items -%}
      {%- comment -%}
      Use the theme's card/list rendering. Important: pass post=post!
      {%- endcomment -%}
      {% include archive-single.html post=post %}
    {%- endfor -%}
  {%- endif -%}
{%- endfor -%}

{%- comment -%}
Optional: show anything uncategorized so nothing is hidden
{%- endcomment -%}
{%- assign categorized = "" | split: "" -%}
{%- for key in order -%}
  {%- assign k = key | strip -%}
  {%- assign items_strict = site.research | where: "category", k -%}
  {%- assign items_array  = site.research | where_exp: "it", "it.categories and it.categories contains k" -%}
  {%- assign categorized = categorized | concat: items_strict | concat: items_array -%}
{%- endfor -%}
{%- assign uncategorized = site.research | where_exp: "it", "categorized contains it == false" -%}
{%- if uncategorized.size > 0 -%}
  <h2>Other</h2><hr />
  {%- for post in uncategorized -%}
    {% include archive-single.html post=post %}
  {%- endfor -%}
{%- endif -%}
